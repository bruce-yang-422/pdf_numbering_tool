# 📌 PDF Numbering Tool

一個以 Python 開發的指令式工具，用於在 PDF 的 **同一頁固定兩個位置** 自動加入 **連續跳號編碼**。適用於宅配單、標籤、單據等需要「每頁多筆編號」的場景。

**Authors:** 楊翔志 & AI Collective  
**Studio:** tranquility-base  
**Email:** bruce.yichai20250505@gmail.com

---

## 📁 專案結構

```
pdf_numbering_tool/
│
├── .venv/                     # 虛擬環境（可忽略）
│
├── input/                     # 使用者放入原始 PDF 的資料夾
│   └── input.pdf
│
├── output/                    # 產生結果 PDF 的資料夾
│   └── [檔名]_numbered.pdf
│
├── scripts/                   # 輔助腳本（未來可加功能）
│
├── numbering_tool.py          # 主程式入口點
├── numbering_tool.txt         # 執行記錄檔（每次執行覆蓋）
├── coords.env                 # 座標＋參數設定檔
│
├── README.md
├── project_structure.txt
├── project_tree_generator.py
└── requirements.txt
```

---

## 🔧 功能摘要

### 核心功能
* 在 **PDF 每頁的兩個指定座標位置** 自動插入編號
* 每頁產生兩個連續編號，如：
  * 第 1 頁 → 01 / 02
  * 第 2 頁 → 03 / 04
  * 依此類推

### 批次處理
* **智能檔名排序**：自動按檔名前綴排序（數字優先，字母次之）
* **批次處理**：可一次處理多個 PDF 檔案
* **選擇模式**：
  * 單一檔案：輸入序號選擇特定檔案
  * 全部檔案：輸入 `ALL` 或直接按 Enter 處理全部
  * **智能跳過**：如果只有一個檔案，自動跳過選擇步驟

### 編號模式
* **模式 1**：每個檔案皆從相同起始編號開始（預設）
* **模式 2**：所有檔案連續編號（上一份接下一份）
  * 例如：檔案1 編號 01-10，檔案2 從 11 開始
* **智能跳過**：如果只有一個檔案，自動跳過模式選擇

### 設定選項
* 起始編號（可自訂）
* 編號位數（01、001、0001…）
* 兩組座標位置（X1, Y1 和 X2, Y2）
* 外框樣式：方框或圓框
* 外框與文字距離（PAD）

### 其他功能
* 使用 reportlab 繪製（**不會降低 PDF 解析度**）
* **Log 記錄**：自動記錄執行過程到 `numbering_tool.txt`（每次執行覆蓋）
* 輸出檔名：自動加上 `_numbered` 後綴，避免覆蓋原始檔案
* 使用者無須開發工具，可後續封裝成 EXE

---

## 📝 安裝方式

建立 virtual environment（可選）：

```bash
python -m venv .venv
```

啟用：

```bash
.venv\Scripts\activate
```

安裝套件：

```bash
pip install -r requirements.txt
```

---

## 🚀 使用方式

1. 將你的 PDF 放入 `input/` 資料夾（可放入多個 PDF）

2. 執行主程式：

```bash
python numbering_tool.py
```

3. 程式執行流程：

   **步驟 1：選擇要處理的檔案**
   * 如果只有 1 個 PDF：自動選擇，跳過此步驟
   * 如果有多個 PDF：
     * 顯示檔案清單（已排序）
     * 輸入序號選擇單一檔案，或輸入 `ALL` 處理全部

   **步驟 2：選擇編號模式**（僅多個檔案時顯示）
   * 模式 1：每個檔案皆從相同起始編號開始（預設）
   * 模式 2：所有檔案連續編號（上一份接下一份）
   * 如果只有 1 個檔案：自動跳過此步驟

   **步驟 3：輸入起始編號**
   * 例如輸入「1」→ 第一頁編號為 `01 / 02`
   * 若設定 3 位數 → `001 / 002`
   * 直接按 Enter 使用預設值 1

4. 產生結果會輸出到 `output/` 資料夾：
   * 檔名格式：`[原始檔名]_numbered.pdf`
   * 例如：`input/example.pdf` → `output/example_numbered.pdf`

5. 執行記錄會自動儲存到 `numbering_tool.txt`

---

## ⚙️ coords.env 設定說明

範例：

```
# ------- 編號座標設定 -------
# PDF 座標系統說明：
# - 原點 (0,0) 位於左下角
# - X 軸向右增加，Y 軸向上增加
# - 單位：points (pt)，1 inch = 72 pt
# 
# 常見頁面尺寸參考：
# - A4 (595 x 842 pt)：最左上角 (0, 842)，最右上角 (595, 842)
# - Letter (612 x 792 pt)：最左上角 (0, 792)，最右上角 (612, 792)

X1=520
Y1=800
X2=520
Y2=400

DIGITS=2
PAD=5

DRAW_BOX=0
DRAW_CIRCLE=1
```

| 參數          | 說明           |
| ----------- | ------------ |
| X1, Y1      | 第一個編號的座標點（左下角為原點）    |
| X2, Y2      | 第二個編號的座標點（左下角為原點）    |
| DIGITS      | 編號位數（1、2、3…） |
| PAD         | 外框與文字距離（px）  |
| DRAW_BOX    | 是否畫方框（1=是，0=否）   |
| DRAW_CIRCLE | 是否畫圓框（1=是，0=否）   |

**注意**：`DRAW_BOX` 和 `DRAW_CIRCLE` 可以同時為 0（都不畫），但建議至少選擇一種以增加可讀性。

---

## 📐 座標系統說明

PDF 依 **左下角為原點 (0,0)**：

* **單位**：points（pt）
  * 1 inch = 72 pt
  * 1 mm ≈ 2.8346 pt
* **X 軸**：向右增加
* **Y 軸**：向上增加

### 常見頁面尺寸參考

| 頁面尺寸 | 寬度 (pt) | 高度 (pt) | 最左上角 | 最右上角 |
|---------|----------|----------|---------|---------|
| A4 | 595 | 842 | (0, 842) | (595, 842) |
| Letter | 612 | 792 | (0, 792) | (612, 792) |

### 單位換算

```
mm → pt：mm × 2.8346 = pt
inch → pt：inch × 72 = pt
```

---

## 📋 Log 記錄

程式執行時會自動記錄到 `numbering_tool.txt`：

* **固定檔名**：`numbering_tool.txt`
* **覆蓋模式**：每次執行會覆蓋舊的 log 檔案
* **記錄內容**：
  * 執行時間
  * 設定檔載入資訊
  * 找到的 PDF 檔案清單
  * 使用者選擇（檔案、編號模式）
  * 每個 PDF 的處理進度
  * 每頁的編號資訊
  * 處理結果統計
  * 錯誤訊息（如有）

